<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="dd.css" />
    <title>Document</title>
  </head>
  <body>
    <div id="IPage"></div>

    <script>
      "use strict";
      // в закладке УРЛа будем хранить разделённые подчёркиваниями слова
      // #Main - главная
      // #Rules- правила игры
      // #Game - сама игра

      // отслеживаем изменение закладки в УРЛе оно происходит при любом виде навигации, в т.ч. при нажатии кнопок браузера ВПЕРЁД/НАЗАД
      window.onhashchange = switchToStateFromURLHash;
      // текущее состояние приложения (это Model из MVC)
      var SPAState = {};

      // вызывается при изменении закладки УРЛа
      // а также при первом открытии страницы
      // читает новое состояние приложения из закладки УРЛа
      // и обновляет ВСЮ вариабельную часть веб-страницы
      // соответственно этому состоянию
      // это упрощённая реализация РОУТИНГА - автоматического выполнения нужных
      // частей кода в зависимости от формы URLа
      // "роутинг" и есть "контроллер" из MVC - управление приложением через URL
      function switchToStateFromURLHash() {
        var URLHash = window.location.hash;

        // убираем из закладки УРЛа решётку
        // (по-хорошему надо ещё убирать восклицательный знак, если есть)
        var stateStr = URLHash.substr(1);

        if (stateStr != "") {
          // если закладка непустая, читаем из неё состояние и отображаем
          var parts = stateStr.split("_");
          SPAState = { pagename: parts[0] }; // первая часть закладки - номер страницы
          //   if ( SPAState.pagename=='Photo' )
          //     SPAState.photoid=parts[1]; // для фото нужна ещё вторая часть закладки - номер фото
        } else SPAState = { pagename: "Main" }; // иначе показываем главную страницу
        //console.log("Новое состояние приложения:");
        //console.log(SPAState);
        // обновляем вариабельную часть страницы под текущее состояние
        // это реализация View из MVC - отображение состояния модели в HTML-код
        var pageHTML = "";
        switch (SPAState.pagename) {
          case "Main":
            pageHTML +=
              '<div id="containerMain"><div id="screenMain"><div class="buttonMain" id="rules" onclick="switchToRulesPage()"><p>Правила игры</p></div><div class="buttonMain" id="startToPlayGame" onclick="switchToGamePage()"><p>Начать игру</p></div></div></div>';
            break;
          case "Rules":
            pageHTML += "<h3>Фото</h3>";
            break;
          case "Game":
            pageHTML +=
              '<div id="startDiv"><input id="nameDiv"><div id="playDiv" onclick= "addName()"></div></div>';
            pageHTML += '<div id="canvas"></div>';
            pageHTML +=
              '<div id="container"><div id="screen"><div id="info"><div id="gameTime"></div><div id="gameCount"></div><div id="lovesCount"></div></div><div id="gameWindow"></div></div></div>';
            break;
        }
        document.getElementById("IPage").innerHTML = pageHTML;
      }

      // устанавливает в закладке УРЛа новое состояние приложения
      // и затем устанавливает+отображает это состояние
      function switchToState(newState) {
        // устанавливаем закладку УРЛа
        // нужно для правильной работы кнопок навигации браузера
        // (т.к. записывается новый элемент истории просмотренных страниц)
        // и для возможности передачи УРЛа другим лицам
        var stateStr = newState.pagename;
        // if ( newState.pagename=='Photo' )
        //   stateStr+="_"+newState.photoid;
        location.hash = stateStr;

        // АВТОМАТИЧЕСКИ вызовется switchToStateFromURLHash()
        // т.к. закладка УРЛа изменилась (ЕСЛИ она действительно изменилась)
      }

      function switchToMainPage() {
        switchToState({ pagename: "Main" });
      }
      function switchToRulesPage() {
        switchToState({ pagename: "Rules" });
      }
      //   function switchToPhotoPage(photoId) {
      //     switchToState( { pagename:'Photo', photoid:photoId } );
      //   }

      function switchToGamePage() {
        switchToState({ pagename: "Game" });
        
      }

      // переключаемся в состояние, которое сейчас прописано в закладке УРЛ
      switchToStateFromURLHash();
    </script>

    <!-- <br /> -->
    <!-- <input type="button" value="Главная" onclick="switchToMainPage()" /> -->
    <!-- <span id="IPhotosButtons"></span> -->
    <!-- <script>
      var photosStr = "";
      for (var photoId in photos) {
        var photo = photos[photoId];
        photosStr +=
          '<input type=button value="' +
          photo.comment +
          '" onclick="switchToPhotoPage(' +
          photoId +
          ')"> ';
      }
      document.getElementById("IPhotosButtons").innerHTML = photosStr;
    </script> -->
    <!-- <input type="button" value="О нас" onclick="switchToGamePage()" /> -->
    <script src="zepto.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="ttt.js"></script>
  </body>
</html>
